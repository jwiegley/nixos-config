groups:
  - name: paperless_availability
    interval: 60s
    rules:
      - alert: PaperlessDown
        expr: paperless_up == 0
        for: 5m
        labels:
          severity: critical
          component: paperless
        annotations:
          summary: "Paperless-ngx service is down"
          description: |
            Paperless-ngx has been unavailable for {{ $value }} checks.
            The document management system is not responding.

            Check service status: systemctl status paperless-scheduler.service paperless-consumer.service paperless-web.service
            Check logs: journalctl -u paperless-scheduler -f
            Check database: systemctl status postgresql

      - alert: PaperlessSchedulerDown
        expr: paperless_scheduler_active == 0
        for: 5m
        labels:
          severity: critical
          component: paperless
        annotations:
          summary: "Paperless scheduler service is down"
          description: |
            The Paperless scheduler service is not running.
            Document processing and background tasks will not run.

            Check service: systemctl status paperless-scheduler.service
            View logs: journalctl -u paperless-scheduler -n 100

      - alert: PaperlessConsumerDown
        expr: paperless_consumer_active == 0
        for: 5m
        labels:
          severity: warning
          component: paperless
        annotations:
          summary: "Paperless consumer service is down"
          description: |
            The Paperless consumer service is not running.
            New documents in the consumption directory will not be processed.

            Check service: systemctl status paperless-consumer.service
            View logs: journalctl -u paperless-consumer -n 100

      - alert: PaperlessWebserverDown
        expr: paperless_webserver_active == 0
        for: 5m
        labels:
          severity: warning
          component: paperless
        annotations:
          summary: "Paperless webserver is down"
          description: |
            The Paperless web interface is not running.
            Users cannot access the document management system.

            Check service: systemctl status paperless-web.service
            View logs: journalctl -u paperless-web -n 100

      - alert: PaperlessHighPendingDocuments
        expr: paperless_pending_documents > 50
        for: 30m
        labels:
          severity: warning
          component: paperless
        annotations:
          summary: "High number of pending documents in Paperless"
          description: |
            There are {{ $value }} documents pending processing in the consumption directory.
            This may indicate a backlog or processing issues.

            Check consumption directory: ls -la /tank/Paperless/consume/
            Check consumer service: systemctl status paperless-consumer.service
            View consumer logs: journalctl -u paperless-consumer -f

      - alert: PaperlessStorageGrowth
        expr: rate(paperless_media_size_mb[1h]) > 100
        for: 2h
        labels:
          severity: warning
          component: paperless
        annotations:
          summary: "Paperless storage growing rapidly"
          description: |
            Paperless media storage is growing at {{ $value }} MB/hour.
            Current size: {{ $value }} MB

            Check storage: du -sh /tank/Paperless/media/
            Monitor for unusual document processing activity

      - alert: PaperlessExporterDown
        expr: up{job="node"} == 1 unless paperless_up
        for: 1h
        labels:
          severity: warning
          component: paperless-exporter
        annotations:
          summary: "Paperless Prometheus exporter is not producing metrics"
          description: |
            The Paperless availability exporter has not updated metrics in 1 hour.

            Check exporter service: systemctl status paperless-exporter.service
            Check exporter timer: systemctl status paperless-exporter.timer
            View exporter logs: journalctl -u paperless-exporter -f
